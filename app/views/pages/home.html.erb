<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container">
    <%= link_to "Home", root_path, class: "navbar-brand" %>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <% if current_user %>
          <li class="nav-item">
            <%= link_to "Products", products_path, class: "nav-link" %>
          </li>
          <li class="nav-item">
            <%= button_to "Logout", destroy_user_session_path, method: :delete, class: "btn btn-danger", data: { turbo: "false" } %>
          </li>
        <% else %>
          <li class="nav-item">
            <%= link_to "Login", new_user_session_path, class: "nav-link" %>
          </li>
          <li class="nav-item">
            <%= link_to "Create Account", new_user_registration_path, class: "nav-link" %>
          </li>
        <% end %>
      </ul>
    </div>
  </div>
</nav>

<div class="container text-center mt-4">
  <h1>Pages#home</h1>
  <p class="text-center">Find me in app/views/pages/home.html.erb</p>

  <% if flash[:alert] %>
    <div class="alert alert-danger">
      <%= flash[:alert] %>
    </div>
  <% end %>
  <% if flash[:notice] %>
    <div class="alert alert-danger">
      <%= flash[:notice] %>
    </div>
  <% end %>

  <% if current_user %>
    <div>
      <h2>Welcome, <%= current_user.email %></h2>
      <% if current_user.role == 'vendor' %>
        <p>You are logged in as a vendor.</p>
      <% else %>
        <p>You are logged in as a regular user.</p>
      <% end %>
    </div>
  <% end %>

  <% unless current_user.nil? %>
    <table class="table mt-4">
      <thead>
        <tr>
          <th>Email</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <% User.where.not(id: current_user.id).each do |user| %>
          <tr>
            <td><%= user.email %></td>
                <td>
                  <% if current_user.following?(user) %>
        <%= button_to "Unfollow", unfollow_user_path(user) %>
      <% else %>
        <%= button_to "Follow", follow_user_path(user) %>
      <% end %>
                </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% end %>
</div>
